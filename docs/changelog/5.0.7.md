# v5.0.7 - Wework Compact AI Prompt Update

**Release Date**: 2026-01-16

## Overview

Updated the wework_compact extension's AI prompt to generate **journalistic news briefs** (200-300 characters, 2-3 sentences) that summarize the key events of the day, replacing the previous brief theme summary. Added configuration options to make length, tone, and focus customizable.

## Changed

### wework_compact Extension

- **AI Prompt**: Updated to generate journalistic news briefs instead of theme summaries
  - Old: 50-100 character theme summary
  - New: 200-300 character (2-3 sentences) factual news brief in news-anchor style
  - Role changed from "新闻摘要专家" (news summary expert) to "新闻编辑" (news editor)
  - Better aligned with v5.0.6 multi-line format where summary is standalone headline

### Technical Implementation

- Modified `_load_prompt_template()` to build default prompt dynamically from config
- Updated both config file prompt and code fallback prompt
- Added `_build_default_prompt()` method for dynamic prompt generation

## Added

### wework_compact Configuration Options

New configuration options in `config/extensions/wework_compact.yaml` under `ai.ai_summary`:

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `target_length` | integer | `250` | Target character count (200-300 recommended) |
| `tone` | string | `"journalistic"` | Summary tone: `journalistic`, `analytical`, or `conversational` |
| `focus` | string | `"facts"` | Content focus: `facts` (what happened), `analysis` (why), `trends` (big picture), or `all` |
| `style` | string | `"concise"` | Writing style: `concise` or `detailed` |

### Example Configuration

```yaml
ai:
  ai_summary:
    target_length: 250               # Target character count (200-300)
    tone: "journalistic"             # journalistic, analytical, conversational
    focus: "facts"                   # facts, analysis, trends, all
    style: "concise"                 # concise, detailed
```

## Files Changed

| File | Changes |
|------|---------|
| `config/extensions/wework_compact.yaml` | Added 5-line `ai_summary` section |
| `config/wework_compact_prompt.txt` | Replaced prompt with journalistic news brief template |
| `extensions/wework_compact/__init__.py` | Added ~80 lines for dynamic prompt building |
| `pyproject.toml` | Bumped version to 5.0.7 |
| `docs/changelog/5.0.7.md` | This changelog |

## Backward Compatibility

- ✅ Existing deployments without new config options work (use sensible defaults)
- ✅ Old config files don't break (new options have hardcoded defaults)
- ✅ Prompt file existence is still optional (code default works)

## Output Format Comparison

### Before (v5.0.6 with old prompt)
```
今日热点: 涵盖电动汽车、中美关系等热点话题 (theme summary, 50-100 chars)

- titleA (platform)
- titleB (platform)
```

### After (v5.0.7 with new prompt)
```
今日热点: 今日，加拿大宣布进口4.9万辆中国电动汽车，引发贸易关注；据报道，美联储主席人选变动导致美股市场波动。 (journalistic brief, 200-300 chars)

- titleA (platform)
- titleB (platform)
```

## Configuration

No configuration changes required - the new defaults work out of the box. To customize the AI summary generation, add the `ai_summary` section to your config file.

## Testing Recommendations

After upgrading, test with:
1. **Default config**: Verify output with all default values
2. **Custom length**: Set `target_length: 400` and check if output is longer
3. **Different tones**: Test `analytical` and `conversational` tones
4. **No config file**: Remove `wework_compact_prompt.txt`, verify code default works
5. **Real data**: Run with actual news data, check output quality

## AI Slop Guardrails

This update follows the principle of **avoiding over-engineering**:
- ❌ No complex prompt engineering (few-shot, chain-of-thought)
- ❌ No multiple prompt templates or variations
- ❌ No AI model-specific tuning parameters
- ✅ Simple, clear prompt with 4 config options
- ✅ Backward compatible with sensible defaults
